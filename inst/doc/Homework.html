<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wang Kexin" />

<meta name="date" content="2023-11-27" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Wang Kexin</h4>
<h4 class="date">2023-11-27</h4>



<div id="hw0" class="section level2">
<h2><strong>HW0</strong></h2>
</div>
<div id="question1" class="section level2">
<h2>Question1:</h2>
<p>A deck of 100 cards(numbered 1,2,…,100) is shuffled and then turned
over one card at a time. Say that a “hit” occurs whenever card i is the
ith card to be turned over for i=1,..,100. Find the expection and
variance of the total number of hits. Write a simulation program to
estimate the expectation and variance of the total number of hits.
Compare your estimates with the exact anwers.</p>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<p>Let Ai be the event that the ith card to be turned over is card i.
Since the card is shuffled and then turned over, we can see that the
event Ai and Aj is independent. The the total number of hits is <span class="math inline">\(\sum_{i=1}^{100}I(A_i)\)</span>. <span class="math display">\[E(\sum_{i=1}^100I(A_i))=\sum_{i=1}^100E(I(A_i))=100/100=1\]</span>,<span class="math display">\[Var(\sum_{i=1}^{100}I(A_i))=\sum_{i=1}^{100}Var(A_i)=100*\frac{1}{100}*\frac{99}{100}=0.99\]</span>
So the expectation and variance of the total number of hits is 1 and
0.99.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>h<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>{</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  {</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="cf">if</span> (x[j]<span class="sc">==</span>j)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>      h[i]<span class="ot">=</span>h[i]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  }</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>(<span class="at">ex=</span><span class="fu">mean</span>(h))</span></code></pre></div>
<pre><code>## [1] 0.9946</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>(<span class="at">var=</span><span class="fu">var</span>(h))</span></code></pre></div>
<pre><code>## [1] 0.9892698</code></pre>
<p>We can see that the simulation result is very close to the real
value.</p>
</div>
<div id="hw1" class="section level2">
<h2><strong>HW1</strong></h2>
</div>
<div id="question1-1" class="section level2">
<h2>Question1:</h2>
<p>Using the inverse transform algorithm to reappear the discrete
distribution</p>
</div>
<div id="answer1-1" class="section level2">
<h2>Answer1:</h2>
<p>We use the function my.sample to generate the discrete
distribution,and then we can compare the probability each value have in
the sample with the true probability.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>{</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>),<span class="at">size=</span><span class="fl">1e5</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>}</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">my.sample</span>()</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">table</span>(data))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>d<span class="sc">/</span><span class="fl">1e5</span><span class="sc">/</span>p</span></code></pre></div>
<pre><code>## [1] 0.992300 1.005850 1.005467 0.994900</code></pre>
<p>From the final result, we can find that the four value are very close
to 1, so the DGP is reasonable.</p>
</div>
<div id="question3.2" class="section level2">
<h2>Question3.2:</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac{1}{2} e^{−|x|}, x\in R.\)</span> Use
the inverse transform method to generate a random sample of size 1000
from this distribution. Use one of the methods shown in this chapter to
compare the generated sample to the target distribution</p>
</div>
<div id="answer3.2" class="section level2">
<h2>Answer3.2:</h2>
<p>since x is a continuous random variable, its cdf is <span class="math display">\[F_X(X)=\begin{cases}
\frac{1}{2}e^x &amp; x\leq 0\\
1-\frac{1}{2}e^{-x}&amp; x&gt; 0\\
\end{cases}\]</span> And the inverse function is <span class="math display">\[F_X^{-1}(X)=\begin{cases}
\log(2x) &amp; 0&lt;x\leq \frac{1}{2}\\
-log(2-2x)&amp; \frac{1}{2}&lt;x\leq 1\\
\end{cases}\]</span> So we can use the folling code to generate the
Laplace distributed variable using inverse transform method.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1000</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>{</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="cf">if</span>(u[i]<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  {</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>    x[i]<span class="ot">=</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u[i])</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  }</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we can use the histogram to compare whether the DGP is true.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span><span class="fu">abs</span>(x)}<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y))<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the graph,we can see that the histogram we produce is close to
the true density, so the DGP is reasonable.</p>
</div>
<div id="question3.7" class="section level2">
<h2>Question3.7:</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed</p>
</div>
<div id="answer3.7" class="section level2">
<h2>Answer3.7:</h2>
<p>for beta(a,b), we can let g(x) is U(0,1) density, then we can find
that <span class="math display">\[max(\frac{f(x)}{g(x)})=max(f(x))=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\leq\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\tag{0&lt;x&lt;1}\]</span>.
So we can choose c equals to <span class="math inline">\(\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\)</span>.The
acceptance rate is <span class="math inline">\(x^{a-1}(1-x)^{b-1}\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>Beta<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,n)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>{</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="cf">while</span>(k<span class="sc">&lt;</span>n)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  {</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    <span class="cf">if</span>(y<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">&gt;</span>u)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    {</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>      k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>      x[k]<span class="ot">&lt;-</span>y</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    }</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  }</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>}</span></code></pre></div>
<p>When a=3,b=2:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">Beta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(<span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fu">gamma</span>(<span class="dv">5</span>)<span class="sc">/</span><span class="fu">gamma</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(<span class="dv">3</span>)<span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kNtmAABmADpmOgBmOjpmOmZmZmZmkLZmkNtmtttmtv+QOgCQOjqQOpCQZjqQkLaQttuQtv+Q29uQ2/+2ZgC2Zjq2kDq2kGa2kJC22/+2/7a2///T09PbkDrbkJDb25Db/9vb////tmb/tpD/25D/27b//7b//9v////KBJmTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJSElEQVR4nO2deWPbNByG1bE2jEGzA0bDMagHDGagJkvy/T8alo9EvvLKOuxf4vf5Y00yR5We6pYsqwM5i5o7AtKhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAmYL2f/yCLvnvu6cpYiJT0Oe3H/FF27d/xY+JTEG7N4/6x/4npW7a+eTzm/zDb4oPty+mMCRFkGFjv7nXP3avleaucdl2VXz4vFCT3k5QyoQI2m9uP+apL2ykN0UGSlWeUT6/Lt8cL1Pf57loowqF29V9/JgJEZQVHgo1u3WRMXJl+keqHozLdus748d+8yx+IZMlSCc4M0vVP+s+B5WgQ9KwFwchgspileh0J+pYcFKlbvvas6y6JG3VUDGQIyhTX3z9VFQzx2yRfJUb6lbE21X1Ydb3v4GRI0j/m7dOu3Wj3PRkku2qrrgzFb8SEiVov7lrC+pWxKl6Xhe7xQnStXRL0CFpOshL4KlYLVJQXQdVrf2u2YztN8ro+yyuDjokeYLrViwpOooNIe2GfUmtmHr+/rD/TWuq+0F5WdPoPPLh5l15WTXSUFXRSpfUD/r1g1Ivde1blS1zeJbUdU2mTEFL6kmnxpArbQy/CvY/9tU1SxqLmVJ0Y98ie9f7pQWN5lOzsFTzQSf+ft/3ne3LBc0HNXs7+x86hayL1bSjP0IEtdj/juekf17wnLQkKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQQLEh1mCUWc/xSO9SnFhTUhIIAFAQYEjRtnXRhgppappB0UYL6dMROwOUIGsotkTPRxQhSfZX0BF2lSxGkyjzUxvjfSA3dZQgqTXQqJUOMWrQg1dLRFVS/XKSgbkHqE1S+XqKgTkYaEFSIXKCgTikaFNTf0HnHIniIwVBm8bIRlL9dmqBODjkv6NPS+kGdDIIELSwHKQdBwdMTJsAoXf1u6i9XUIzg2vnHsoiFNiRWkHLLQYJTFDY45VjEQsahjojI4CgIh+MqKGyaZAoq0ylL0G4d4rSiQL2G8l9XQUENGWGleTfG97yZIFGrl3ekCToEcBQianUY7oKCdsda79Pj+VdBgvMJwq0nHXoav/F9fQLWQ33MrH9wniE4Cer8RzhB+lC10kzmnoWkCAq3zmG0Yt2jwzyCCxCAl6BTXgoVod2r0o9H9jn4CzK/L1RQOqegxtf9BB3XivxiVEcpOdX6czXzg8umIgSdclCg4By+CmdYxwkKtJQ47vv7jXlSqHdwza92ZuAvT1Bal79sqCB65SDBgnbr++ps2XP96OqBF5qhQzAlCQqzGD3m+7v18fDdoc6Ae3Qs6mTxgmLmIJsp6LGCyk1FrjHqpCgvZsVzGs6Mw47nNwevg6xmWGcWlNw+6WfHJOemzeqKatCiY3TsZlhHCwqxncEYiz3kGeNhlqGG5Qzr/IL0mbwzDDVsZ1jHCwqw38MoYnf6sPT6sTmAIY3XLCivX24ee04DtwrFZ/7OegraQZD/Yr2AZR8KsvtKHEEBixgciI4LbvQ3xAtKQjykYnR0xkxBzytId6QBx/HscD4bG51RU9BugkJNchoj0UHwo1BGxmbcFPS8gqwaeHiRdWyGb0yRKqgYZ0DQRfaCOsmJVgf5GTJ3d0zZiqlOaqQLCoNEQX5pnFHQ6EWMuQXlhez2KfHbITRC0PhFjJkFZTePqR7NT7Nw6NJoOXcUfQwZzfx9MdM80XyQ08BzVkG6o6gFTTOj2M1AMQV5rUbVL+oclHg99u2KBVV1kOeDJy1j0rPII19Q2VX03EVlF5O+RZ4LEBQCq+B6F3miCvJZ8XX+pntwlymoHIv5PpjTJiL9q2DSBVUPUU4999pbRGRgkUe4oKyunLeryK3Y0BpGXEE+uyo0xkTY2bV5y+B6PofTY7IFGSOwOEMN1U7B1IJ89p0crLZGjQmu5/N2Aiio9Xk7/gsTBNfmVTv6kwvy2bo0VQ5S51MSSZDn/VG1ILgk6C9IgZREEtR+4bF0F4AzglR/vCcTVL+SKkgNxZuCis8p6Hxw+EaM+IKql0IFhUjsFQvyvfcrjKDytURBjkfdLEZQ3xQ0BTU/o6Dh4PpnWCmo+YkMQcUbCYJc9tctS1AnehTUK+iUcSioT1CnE3v9gizvm1edqAkRpN/FFGR733zZnC5PkPVdz6qlZymCrO+b7zbrUgR9Gn0LYqwctEhBlvfNu60rX4Ugm/vmleP2sYkEjb65JXQ/yHnzz1IEHSio4Px985IFzTPUaK3r9ozmBTGHoEuCghDjkhx4sHoJRBSEB6uXQDxBFkONwV8jiXExH3GtxzYr6/3T0QOJWUn75KAQl4gXZDFY9fg11yAID1Y9fs1VCHKGgvx/DQV5X0JBUwRCQQEu8bh8eVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAXEGZcaRVsejospxmBnLYrpTrA3O3L44rMZn9UVtRBekzZepzZfab/EXqkDgzkEN2+3SwfHBDm936uFTVCBIQU1C5TFQdJ1OeuzP+6JRGIOUbp/NXstOCeSNIRExBPU5s/24DgWy/dD2DLlP3x8XOUX+rqIKK5DQWYccfnN8IJHv259r5KYwnQd14DRNTUJldzEzjsOmhEUiqi4njw1FORrrxOsOkgjLHOvok6GbE374TkjhB7azstGmmEUhZbziesyaviLUqQ7cT9hqBlIlyrKrlVdLN5tTxlNhGIOUGHN8iJqaZb3TItivXxsfs1eltN8YunHEBieso6lxTdOl1u5OW+0IcDtM1Ain6e17NfBlKKmSocQ1QEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQGkC9L7wIxHVE6PdEH1U95nQ7ogvTX6ld8TzP0QL+iQuN68Egb5gjK3zZ+hEC9ov/l21lMbxQtKb/913NUaBumC9M5ov0e/eiJdUFJsjJ6xmpYuaHYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA//pv5X9nu2xjAAAAAElFTkSuQmCC" /><!-- --></p>
<p>From the graph,we can see that the histogram we produce is close to
the true density, so the DGP is reasonable.</p>
</div>
<div id="queation3.9" class="section level2">
<h2>Queation3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function
<span class="math display">\[f_e(x) = \frac{3}{4}(1 − x^2), |x| \leq 1.
\tag{3.10} \]</span>.Devroye and Gyo¨rﬁ [71, p. 236] give the following
algorithm for simulation from this distribution. Generate iid U1,U2,U3 ∼
Uniform(−1, 1). If |U3| ≥|U2| and |U3| ≥ |U1|, deliver U2; otherwise
deliver U3. Write a function to generate random variates from fe, and
construct the histogram density estimate of a large simulated random
sample.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer:</h2>
<p>using the algorithm above</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ek<span class="ot">&lt;-</span><span class="cf">function</span>(n)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>{</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  {</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    x[i]<span class="ot">=</span>u[<span class="dv">3</span>]</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(u[<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fu">abs</span>(u[<span class="dv">2</span>])<span class="sc">&amp;&amp;</span><span class="fu">abs</span>(u[<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fu">abs</span>(u[<span class="dv">1</span>]))</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    {</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>      x[i]<span class="ot">=</span>u[<span class="dv">2</span>]</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    }</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  }</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">ek</span>(<span class="dv">1000</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="dv">3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the graph,we can see that the histogram we produce is close to
the true density, so the DGP is reasonable.</p>
</div>
<div id="question" class="section level2">
<h2>Question:</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates
from the density <span class="math inline">\(f_e\)</span> (3.10)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer:</h2>
<p>Since U1,U2,U3 ∼ Uniform(−1, 1), their absolute value is uniform(0,1)
distributed.We can also generate U by generate V from uniform (0,1), the
U=V or U=-V by equal probability. From then DGP, we can know that the
value delivered is not the maximum, so it can be the smallest, or the
second smallest with probability 0.5,0.5.Denote <span class="math display">\[Y=\frac{1}{2}V_1+\frac{1}{2}V_2\]</span>, then
U=Y or U=-Y The cdf of the smallest V is <span class="math display">\[\sum_{i=1}^3C_3^iy^i(1-y)^{1-i}=3y(1-y)+y^3\]</span>,
the second smallest value’s cdf is <span class="math display">\[\sum_{i=2}^3C_3^iy^i(1-y)^{1-i}=3y^2(1-y)+y^3\]</span>,
so the cdf of Y is <span class="math display">\[\frac{1}{2}*3y(1-y)+y^3+\frac{1}{2}*3y^2(1-y)+y^3=\frac{1}{2}(3y-y^2)\]</span>.
So the density of Y is <span class="math display">\[\frac{3}{2}(1-y^2)\tag{0&lt;y&lt;1}\]</span>. The
density of U is <span class="math display">\[\frac{1}{2}*\frac{3}{2}(1-u^2)=\frac{3}{4}(1-u^2)\tag{-1&lt;u&lt;1}\]</span></p>
</div>
<div id="hw2" class="section level2">
<h2><strong>HW2</strong></h2>
</div>
<div id="question-1" class="section level2">
<h2>Question:</h2>
<p>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span>should take to minimize
the asymptotic variance of <span class="math inline">\(\hat{pi}\)</span>? (m ∼ B(n, p), using <span class="math inline">\(\delta\)</span> method). Then take three different
values of <span class="math inline">\(\rho\)</span> (0 ≤ <span class="math inline">\(\rho\)</span> ≤ 1, including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo
simulation to verifyyour answer. (n = <span class="math inline">\(10^6\)</span>, Number of repeated simulations K =
100)</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer:</h2>
<p>the estimation of <span class="math inline">\(\pi\)</span> is <span class="math inline">\(\frac{2l}{d\hat{p}}=\frac{2\rho}{\hat{p}}\)</span>,
where <span class="math inline">\(\hat{p}=\frac{n}{m}\)</span>,
n~B(m,p). Then, the variance of <span class="math inline">\(\hat{p}\)</span> is <span class="math display">\[Var(\hat{p})=\frac{p(1-p)}{m}\]</span>. Since
<span class="math display">\[\hat{\pi}=\frac{2\rho}{\hat{p}}\]</span>,
we can get <span class="math display">\[Var(\hat{\pi})=\frac{p(1-p)}{m}*\frac{4\rho^2}{p^4}\]</span>
using the <span class="math inline">\(\delta\)</span> method. Hence, to
minimize the asymptotic variance, <span class="math inline">\(\rho\)</span> should be 1. Using the Monte Carlo
simulation, we count the event when <span class="math inline">\(\frac{l}{2}sin(Y)\leq X\)</span>, where <span class="math inline">\(X\in(0,\frac{d}{2})\)</span> that’s equivalent to
<span class="math inline">\(sin(Y)\leq X\)</span>, where <span class="math inline">\(X\in(0,\frac{1}{\rho})\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>rho<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>variance<span class="ot">&lt;-</span><span class="cf">function</span>(r)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>{</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  {</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    m<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span>r)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    Y<span class="ot">&lt;-</span><span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>    pihat<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>r<span class="sc">/</span><span class="fu">mean</span>(<span class="fu">sin</span>(Y)<span class="sc">&gt;</span>x)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    p[i]<span class="ot">=</span>pihat</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  }</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">var</span>(p))</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>(<span class="fu">c</span>(<span class="fu">variance</span>(<span class="fl">0.5</span>),<span class="fu">variance</span>(<span class="fl">0.8</span>),<span class="fu">variance</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [1] 1.829620e-05 9.502789e-06 4.481615e-06</code></pre>
<p>So, we can see that when <span class="math inline">\(\rho=1\)</span>,
the variance is smallest.</p>
</div>
<div id="question5.6" class="section level2">
<h2>Question5.6:</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\theta=\int_{0}^{1}e^xdx\]</span>. Now consider
the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U, e^{1−U})\)</span> and <span class="math inline">\(Var(e^U + e^{1−U})\)</span>, where U ∼
Uniform(0,1). What is the percent reduction in variance of <span class="math inline">\(\hat{theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer:</h2>
<p><span class="math display">\[\begin{aligned}
Cov(e^U,e^{1-U})
&amp; =E(e^Ue^{1-U})-E(e^U)E(e^{1-U})\\  
&amp; = e-(\int_{0}^{1}e^Udu)(\int_{0}^{1}e^{1-U}du)\\
&amp; = e-(e-1)^2
\end{aligned}\]</span>. The variance <span class="math display">\[\begin{aligned}Var(e^U + e^{1−U})
&amp;=E[(e^U+e^{1-U})^2]-(E(e^U+e^{1-U}))^2\\
&amp; = E(e^{2U}+e^{2-2U}+2e)-(2e-2)^2\\
&amp; =e^2+2e-1-(2e-2)^2\\
&amp; = -3e^2+10e-5\end{aligned} \]</span> The simple estimator is <span class="math display">\[\hat{\theta}=\frac{1}{m}\sum_{i=1}^me^{U_i}\]</span>,
and it’s variance is <span class="math display">\[\frac{1}{m}var(e^U)=\frac{1}{m}(-\frac{1}{2}e^2+2e-\frac{3}{2})\]</span>
The antithetic variable estimator is <span class="math display">\[\hat{\theta}=\frac{1}{m}\sum_{i=1}^{m/2}(e^{U_i}+e^{1-U_i})\]</span>
and it’s variance is <span class="math display">\[\frac{1}{m^2}*\frac{m}{2}*Var(e^U +
e^{1−U})=\frac{1}{2m}(-3e^2+10e-3)\]</span> So the percent reduction is
<span class="math display">\[\frac{\frac{1}{m}(-\frac{1}{2}e^2+2e-\frac{3}{2})-\frac{1}{2m}(-3e^2+10e-5)}{\frac{1}{m}(-\frac{1}{2}e^2+2e-\frac{3}{2})}=96.767\%\]</span>
So the reduction in variance is 96.767%.</p>
</div>
<div id="queation5.7" class="section level2">
<h2>Queation5.7:</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer:</h2>
<p>We can use the following code to do comparison.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>{</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  U1<span class="ot">&lt;-</span>U[<span class="dv">1</span><span class="sc">:</span>m<span class="sc">/</span><span class="dv">2</span>]</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  x1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(U))</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  x2[i]<span class="ot">&lt;-</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(U1))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U1)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>((<span class="fu">var</span>(x1)<span class="sc">-</span><span class="fu">var</span>(x2))<span class="sc">/</span><span class="fu">var</span>(x1))</span></code></pre></div>
<pre><code>## [1] 0.9739388</code></pre>
<p>So the numerical result is close to the empirical result.</p>
</div>
<div id="hw3" class="section level2">
<h2><strong>HW3</strong></h2>
</div>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<p><span class="math inline">\(Var(\hat{\theta}^M) =
\frac{1}{Mk}\sum_{i=1}^k\sigma_i^2 +Var(\theta_I) =
Var(\hat{\theta}^S)+Var(\theta_I)\)</span>, where <span class="math inline">\(\theta_i = E[g(U)|I = i],\sigma_i^2= Var[g(U)|I =
i]\)</span> and I takes uniform distribution over {1, . . . , k}. Proof
that if g is a continuous function over (a, b), then <span class="math inline">\(Var(\hat{\theta}^S)/Var(\hat{\theta}^M)\rightarrow0\)</span>
as <span class="math inline">\(b_i-a_i\rightarrow0\)</span> for all i =
1,…,k.</p>
</div>
<div id="answer1-2" class="section level2">
<h2>Answer1</h2>
<p>Solution: Consider <span class="math inline">\(Var(\hat{\theta}^S)\)</span>: <span class="math display">\[Var(\hat{\theta}^S)=\frac{1}{Mk}\sum_{i=1}^k\sigma_i^2\]</span>,where<span class="math display">\[\sigma_i^2= Var[g(U)|I = i]\]</span>,when<span class="math inline">\(b_i-a_i\rightarrow0\)</span>, the function g(U) is
a constant in the interval <span class="math inline">\([a_i,b_i]\)</span>, so <span class="math inline">\(\sigma_i^2=0\)</span>. Hence, by the chebyshev law
of large number, we can get <span class="math inline">\(\frac{1}{k}\sum_{i=1}^k\sigma_i^2\rightarrow0\)</span>
as<span class="math inline">\(b_i-a_i\rightarrow0,k\rightarrow\infty\)</span>.
That’s to say <span class="math inline">\(Var(\hat{\theta}^S)\rightarrow0\)</span>,and <span class="math inline">\(Var(\hat{\theta}^S)/Var(\hat{\theta}^M)\rightarrow0\)</span></p>
</div>
<div id="question2" class="section level2">
<h2>Question2:</h2>
<p>Find two importance functions f1 and f2 that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x) = \frac{x^2}{\sqrt{2π}} e^{-x^2/2}, x&gt;
1.\]</span> Which of your two importance functions should produce the
smaller variance in estimating<span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2π}}e^{−x^2/2}dx\]</span>
by importance sampling? Explain.</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2:</h2>
<p>From the formation of g(x), we can find that a normal distribution or
gamma distribution may ‘close’ to the given function g(x). So,let’s
choose N(1,1) and Gamma(1.5,0.5) that’s translated to x&gt;1 . We can
use the graph to see their difference.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>y<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">1</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dgamma</span>(x<span class="dv">-1</span>,<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">inset=</span><span class="fl">0.02</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb/9vb////tmb/25D//7b//9v///+jsVLVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIMElEQVR4nO2di3ajNhRFlTRJO56p27hTpsTm/3+zSIDBDtLRE12Ts9fKxCXkKt6IKwmpsuqIE1X7D5AOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCZBakHoZagvKGK8cOBJWtPnsQlC/USuiNBYXf2h4x84VaCc0aBEJTEAhNQSC0AEGp+Wj3ggSFWgldX1By4J0LUsmxdy4oPfYXECQm1Ero6oLS4z6koJNSr5djP6L4E4VT4cFtofJTTFDz8l/v6LXrzodvPuG+mqDLsdfSPr13g6rUcIAsoS7Hqa6fv78vQxcRdD70pbXP/3bTv45wQnJQ83p92c7XVEANGr4njTZyCDKXdGSuTBvkIKMqOZyblFB9Y/L0d38ldUVv+i+TM+eLKqEVSych1Kl30qpe0Gm8mMbNUPfH0LX7QSo9+l2DGDBF8fGmr9/p6X1obNvnnyZBD4fH0LsTFMLYjmhBRonJCsu+yQaCGtSKpRMfqpkEjXWmHTLCpoLuo9xW9rnSJ4TPVoMuxx/mQE1Bn8Kp9Hss/leHitNMOah5+WUaXYk5KEeoCG5aMV2NTJ3aohUzTXyPJQMJyUGmO/L8j7bUf536Jv5yfN2kH9So8S5ulUdHMXFAn+q6NR3EucO2eF10qDHgM9RQaY9dE3PQmH82HYstrgEarKY/Dkr57VZNnf1tR/MBNSg4NgiVl4I5aLweXjkoPH6m3/QJXagVOx+GVsxSf9aGGtHv8yEFeYerOhbzCV1bUIbwCb/aKJMCPv6wdNdECapwi42DrvPB1p8VIEh9OhIdKpyhO9LaO/z1BeWIGh3j402r6RtaW2dNgKDFgegH96k1yN6bFSUofmZj5ZGr4/uSBxCkPh2JDhUBBQEeQFCOIigoIpQfAgXdz1DlGNTvStB9OAoKCRfZ0H+NwWpCGbsWVHWo4RValqCoQnYt6O7gLgSdD+rVdWJguJuDuxBknsPZnsWHFH0X1fxnzJuVJ6jL4Gj/OahxzbyPzMskYDjXUUCCIP1M2iwjsE9OxQlqzYTk5WiZ1ZkmfRzLF2zlRrzblJ70t/5NPL33otbTapwg/fYHM9Yu+jhfiGvQffExSShtqDGuEVp/J5Gt2NO768TxJK1QuKDhmbR52a6/p5L9oFNfZHAOiijn8yNX99eSeZHFKWMN8qVR32IEhZM+mrcuISjbk/54+y34Fts6SY+PO2xd38JDjb4BjRAUXFCyIOsSFHFjsbiCUgU19i7vBoLCF5IHN2SJghp7NZf2THo8sq2gjzfHkKn+LbYmKDJUBFpQM1yv7ftB24UTOlh1k7CQPPgee0RB3gvJV6J+BUH+y4BzPPV4QEEBC8mTy3pIQaELyeNLijk/LHSpHOS5kHwt6lcQ5L2Q3BI1qLCHFJQUToUNN/Yv6H71YMif1e1ckHnMp1/f1RkKugq6DlsXigKb+YJUF7SsOfPLgnUimNo16DYXlSsvmtqCbg+q+acUZP5Va0fH3J23wFhq5yD7YQpaPbyWm6oiKgd1ksyMbCzI46H9px5SXYTdYt2yblHQ+k/U51cVkZaDuqsXCXa62oIsj6RVgQJjkXeLdYvqJUCSSEFz/apvSOItthyUVTckU9CUhqrrqS3I8XMBbgyFBKVv8jbVodqmygjynZt3BRUybi0iyHtm1d3YT3UooOT8FBGUOjc/nSMhD9WtQahMAXmoVA7ym5vHbZm6+V6BQq2Y59w8Dlp95Cq1H7Q4s26yli+osqLSgtwLyX2Dzk9p9bdNRdV9Jh0UtNwMvIWwP7HiLVYVCgKIHaxKoe5g9QGoNtR4GEoI8hisJhTj0f3eqJzo0z1qUEIxOxDkMVhNKGYPgvBgNaGYXQiKhoLSi6Gg5FMoaIsgFJThlITTvx4UBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIsIEg18bFC07u57h6h1awZbret8y+9V13/Uy/1ra32RrlBTk3Lp5p3Q+69efsng/OIE1fTusyNH6mn94B17IL7grlBTk3Lr5yPjgFDTNOziDmA6/N54NbGD/TbwjlOO+WrXIQumTNy18uQR+/wyuOBE2f6ed3wa5sJciycfFEL8CZg9rnnweUyOAtNswHD669p4Y3EgRmGnW1dwpq9N0x1BFXISD5GitDXfZOQtsIsm5cPKJnst2CnvBl15XUuUOpXEFoptrUercgo8ax07dXbpF6izk2Lp5OGLC//eH9OFO1R80QmqRdGxcvcNag8cN3Xe9qeOPOU1qRzbw7Lcy4e9I6Sy2W36wG8MtB4jqKzo2LF4ChRovHKyd0yli9GllDjQeHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAggXZBeCXY+BO41kxPpgvSiqdDNirIiXZBeIf3de7VTAcQL6k7wf/MoinxB7sXzxREv6HL8EbihXF7EC2pefrkXtxZGuiC9QDp0T8KsSBd0MuujK6Zp6YKqQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4H9DfK/hZLxPoAAAAASUVORK5CYII=" /><!-- --></p>
<p>Besides, we can also compare the ratio <span class="math inline">\(\frac{g(x)}{f(x)}\)</span>, we desire the ratio to
be close to a constant.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">plot</span>(x,y<span class="sc">/</span>(<span class="fu">dgamma</span>(x<span class="dv">-1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>)),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">lines</span>(x,y<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">1</span>)),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">inset=</span><span class="fl">0.02</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="at">lty=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Hence, the inportance function f1 is more suitable.</p>
</div>
<div id="question3ex5.14" class="section level2">
<h2>Question3(EX5.14):</h2>
<p>Obtain a Monte Carlo estimate of<span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}} e^{−x^2/2}
dx\]</span> by importance sampling.</p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<p>Using the two importance function f1 and f2, we can get</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>e1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>{</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">rchisq</span>(<span class="dv">10000</span>,<span class="dv">1</span>))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>g<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>e1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>}</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>e2<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) </span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>{</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">10000</span>,<span class="fl">1.5</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">dgamma</span>(x<span class="dv">-1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>)</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>g<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>e2[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1),<span class="fu">mean</span>(e2))</span></code></pre></div>
<pre><code>## [1] 0.4006390 0.4005857</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(e1),<span class="fu">var</span>(e2))</span></code></pre></div>
<pre><code>## [1] 1.942568e-07 1.235631e-06</code></pre>
<p>From the above result, we can see that the variance of f1 is smaller
than the variance of f2. And for f1, it’s Monte Carlo estiomation is
0.4006</p>
</div>
<div id="question4ex5.15" class="section level2">
<h2>Question4(EX5.15):</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="answer4" class="section level2">
<h2>Answer4:</h2>
<p>On the jth subinterval, variables are generated from the density
<span class="math display">\[\frac{5e^{-x}}{1-e^{-1}},\ \ \ \ \
(\frac{j-1}{5}&lt;x&lt;\frac{j}{5})\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>m<span class="ot">&lt;-</span>M<span class="sc">/</span>k</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,k)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,k)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>   <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>   k<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>{</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(m,(i<span class="dv">-1</span>)<span class="sc">/</span>k,i<span class="sc">/</span>k)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  e[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(d)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  v[i]<span class="ot">&lt;-</span><span class="fu">var</span>(d)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>}</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="fu">sum</span>(e);</span></code></pre></div>
<pre><code>## [1] 0.5249007</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">mean</span>(v);</span></code></pre></div>
<pre><code>## [1] 1.746952e-05</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(v))</span></code></pre></div>
<pre><code>## [1] 0.004179655</code></pre>
<p>The stratified Monte Carlo estimator is the summation of estimator in
the subinterval, and it’s variance is <span class="math inline">\(E(\sigma_j^2)\)</span>, from the result, we can
see that, the result is very small. Compare it with the result in
Example 5.10, which is the simulation withour statification:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(M)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>(e<span class="ot">&lt;-</span><span class="fu">mean</span>(d))</span></code></pre></div>
<pre><code>## [1] 0.5227307</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>(v<span class="ot">&lt;-</span><span class="fu">var</span>(d))<span class="co">#variance of estimator without classification</span></span></code></pre></div>
<pre><code>## [1] 0.00953424</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>(<span class="fu">sqrt</span>(v))</span></code></pre></div>
<pre><code>## [1] 0.09764343</code></pre>
<p>We can see that the variance of this estimator is obviously larger
than the stratified estimator.</p>
</div>
<div id="question5ex6.5" class="section level2">
<h2>Question5(EX6.5):</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but
the sample data are non-normal. Then the probability that the confidence
interval covers the mean is not necessarily equal to 0.95. Use a Monte
Carlo experiment to estimate the coverage probability of the t-interval
for random samples of <span class="math inline">\(\chi^2(2)\)</span>
data with sample size n = 20. Compare your t-interval results with the
simulation results in Example 6.4. (The t-interval should be more robust
to departures from normality than the interval for variance.)</p>
</div>
<div id="answer5" class="section level2">
<h2>Answer5:</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>{</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  L[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  U[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>}</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="fu">sum</span>(L<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">&amp;</span>U<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 9180</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">mean</span>(L<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">&amp;</span>U<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<p>We can find that the CP for mean is slightly smaller than 95%. Let’s
see the variance now.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>UV<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>{</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>  UV[i]<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">qchisq</span>(<span class="fl">0.05</span>,n<span class="dv">-1</span>)</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>}</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="fu">sum</span>(UV<span class="sc">&gt;</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 7836</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">mean</span>(UV<span class="sc">&gt;</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.7836</code></pre>
<p>We can find the CP for variance is 78%, is far from 95%, so The
t-interval should be more robust to departures from normality than the
interval for variance.</p>
</div>
<div id="question6ex6.a" class="section level2">
<h2>Question6(EX6.A):</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(\alpha\)</span>, when the
sampled population is non-normal. The t-test is robust to mild
departures from normality. Discuss the simulation results for the cases
where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii)
Exponential(rate=1). In each case, test H0 : <span class="math inline">\(\mu=\mu_0\)</span> vs H0 : <span class="math inline">\(\mu\neq\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and
Exponential(1), respectively.</p>
</div>
<div id="answer6" class="section level2">
<h2>Answer6:</h2>
<p>For the significance level <span class="math inline">\(\alpha\)</span>, let’s see if the sampled
population is non-normal</p>
<p>Let’s see the <span class="math inline">\(\chi^2(1)\)</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>{</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>  L[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>  U[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>}</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="fu">sum</span>(L<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">|</span>U<span class="sc">&lt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1091</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">mean</span>(L<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">|</span>U<span class="sc">&lt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1091</code></pre>
<p>We can see that the empirical type I error is about 0.1, which is
unequal to 0.05</p>
<p>Let’s see the <span class="math inline">\(Uniform(0,2)\)</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>{</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>  L[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>  U[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>}</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="fu">sum</span>(L<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">|</span>U<span class="sc">&lt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 530</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">mean</span>(L<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">|</span>U<span class="sc">&lt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.053</code></pre>
<p>We can see that the empirical type I error is about 0.05, and it’s
approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span></p>
<p>Let’s see the Exponential(rate=1)</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10000</span>)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>{</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  L[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  U[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span>t<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a><span class="fu">sum</span>(L<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">|</span>U<span class="sc">&lt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 809</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">mean</span>(L<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">|</span>U<span class="sc">&lt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.0809</code></pre>
<p>We can see that the empirical type I error is about 0.08, and it’s
slightly larger than the nominal significance level <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="hw4" class="section level2">
<h2><strong>HW4</strong></h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Consider m=1000, and the first 95% null hypotheses hold, the last 5%
alternative hypotheses hold. Under the null hypothesis, the p-value is
uniformly distributed and <span class="math inline">\(p\sim
U(0,1)\)</span>. Under the alternative hypothesis, <span class="math inline">\(p\sim Beta(0.1,1)\)</span>. Using the Bonferroni
adjustment and the B-H adjustment to generate adjusted p-value. Compare
the value with <span class="math inline">\(\alpha = 0.1\)</span> to
determine whether you should reject the null hypothesis. Based on M=1000
permutations, estimate FWER,FDR,FDR and TPR and output the result to the
table.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">1000</span>; Bonf<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">3</span>);BH<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">3</span>);</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>{</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  p_value<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  p_value[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  p_value[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  p_bonf<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p_value,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>  p_BH<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p_value,<span class="at">method=</span><span class="st">&quot;BH&quot;</span>)</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>  bonf<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>); <span class="do">##拒绝第i个假设，记为1</span></span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>  bh<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>); <span class="do">##拒绝第i个假设，记为1</span></span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>  {</span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>    <span class="cf">if</span> (p_bonf[j]<span class="sc">&lt;</span><span class="fl">0.1</span>) </span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a>    {</span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>      bonf[j]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>    }</span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>    <span class="cf">if</span> (p_BH[j]<span class="sc">&lt;</span><span class="fl">0.1</span>) </span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>    {</span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>      bh[j]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>    }</span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>  }</span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>  FWER1<span class="ot">&lt;-</span>(<span class="fu">sum</span>(bonf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>])<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a>  FWER2<span class="ot">&lt;-</span>(<span class="fu">sum</span>(bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>])<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a>  FDR1<span class="ot">&lt;-</span><span class="fu">sum</span>(bonf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>])<span class="sc">/</span><span class="fu">sum</span>(bonf)</span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a>  FDR2<span class="ot">&lt;-</span><span class="fu">sum</span>(bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>])<span class="sc">/</span><span class="fu">sum</span>(bh)</span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a>  TPR1<span class="ot">&lt;-</span><span class="fu">sum</span>(bonf[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>])<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a>  TPR2<span class="ot">&lt;-</span><span class="fu">sum</span>(bh[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>])<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a>  Bonf[i, ]<span class="ot">=</span><span class="fu">c</span>(FWER1,FDR1,TPR1)</span>
<span id="cb59-30"><a href="#cb59-30" tabindex="-1"></a>  BH[i, ]<span class="ot">=</span><span class="fu">c</span>(FWER2,FDR2,TPR2)       </span>
<span id="cb59-31"><a href="#cb59-31" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s see the final result.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>output<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Bonf[,<span class="dv">1</span>]),<span class="fu">mean</span>(Bonf[,<span class="dv">2</span>]),<span class="fu">mean</span>(Bonf[,<span class="dv">3</span>]),<span class="fu">mean</span>(BH[,<span class="dv">1</span>]),<span class="fu">mean</span>(BH[,<span class="dv">2</span>]),<span class="fu">mean</span>(BH[,<span class="dv">3</span>])),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>,<span class="st">&quot;BH&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)))</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##             FWER         FDR     TPR
## Bonferroni 0.097 0.005090286 0.39894
## BH         0.925 0.096256713 0.56148</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=1/\bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expection of <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n/(n-1)\)</span> so that the estimation
bias is <span class="math inline">\(\lambda /(n-1)\)</span>. The
standard error <span class="math inline">\(\hat{\lambda}\)</span> is
<span class="math inline">\(\lambda n/[(n-1)\sqrt{n-2}]\)</span>.
Conduct a simulation study to verify the performance of the bootstrap
method.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>When n=5</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span>;m<span class="ot">&lt;-</span><span class="dv">1000</span>;n<span class="ot">=</span><span class="dv">5</span>;</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>Bias<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>SE<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>{</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  {</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>    lambdastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  }</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>  Bias[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda</span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>  SE[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(lambdastar)</span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>}</span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(Bias),<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>),<span class="fu">mean</span>(SE),<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))</span></code></pre></div>
<p>When n=10</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span>;m<span class="ot">&lt;-</span><span class="dv">1000</span>;n<span class="ot">=</span><span class="dv">10</span>;</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>Bias<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>SE<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>{</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  {</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>    lambdastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>  }</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>  Bias[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda</span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>  SE[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(lambdastar)</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>}</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(Bias),<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>),<span class="fu">mean</span>(SE),<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))</span></code></pre></div>
<p>When n=20</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span>;m<span class="ot">&lt;-</span><span class="dv">1000</span>;n<span class="ot">=</span><span class="dv">20</span>;</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>Bias<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>SE<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>{</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  {</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>    lambdastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>  }</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>  Bias[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>  SE[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(lambdastar)</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>}</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>d3<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(Bias),<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>),<span class="fu">mean</span>(SE),<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))</span></code></pre></div>
<p>So the final result is</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>output<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(d1,d2,d3),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">4</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;n=5&quot;</span>,<span class="st">&quot;n=10&quot;</span>,<span class="st">&quot;n=20&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Bias(Bootstrap)&quot;</span>,<span class="st">&quot;Bias(Theoretical)&quot;</span>,<span class="st">&quot;SE(Bootstrap)&quot;</span>,<span class="st">&quot;SE(Theoretical)&quot;</span>)))</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##      Bias(Bootstrap) Bias(Theoretical) SE(Bootstrap) SE(Theoretical)
## n=5        0.6306287         0.5000000     3.1990296       1.4433757
## n=10       0.2183723         0.2222222     0.8124085       0.7856742
## n=20       0.1025920         0.1052632     0.4966515       0.4962153</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap).</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>x<span class="ot">&lt;-</span>law<span class="sc">$</span>LSAT</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>y<span class="ot">&lt;-</span>law<span class="sc">$</span>GPA</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>correlation<span class="ot">&lt;-</span><span class="fu">cor</span>(x,y)</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>Tobs<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>SED<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>{</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>  xstar<span class="ot">&lt;-</span>x[index]</span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>  ystar<span class="ot">&lt;-</span>y[index]</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>  R[b]<span class="ot">&lt;-</span><span class="fu">cor</span>(xstar,ystar)</span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>  RR<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>  {</span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>    index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a>    xre<span class="ot">&lt;-</span>xstar[index]</span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a>    yre<span class="ot">&lt;-</span>ystar[index]</span>
<span id="cb67-22"><a href="#cb67-22" tabindex="-1"></a>    RR[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(xre,yre)</span>
<span id="cb67-23"><a href="#cb67-23" tabindex="-1"></a>  }</span>
<span id="cb67-24"><a href="#cb67-24" tabindex="-1"></a>  SED[b]<span class="ot">&lt;-</span><span class="fu">sd</span>(RR)</span>
<span id="cb67-25"><a href="#cb67-25" tabindex="-1"></a>}</span>
<span id="cb67-26"><a href="#cb67-26" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sd</span>(R)</span>
<span id="cb67-27"><a href="#cb67-27" tabindex="-1"></a>Tobs<span class="ot">=</span>(R<span class="sc">-</span>correlation)<span class="sc">/</span>SED</span>
<span id="cb67-28"><a href="#cb67-28" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">quantile</span>(Tobs,<span class="fl">0.025</span>)</span>
<span id="cb67-29"><a href="#cb67-29" tabindex="-1"></a>t2<span class="ot">&lt;-</span><span class="fu">quantile</span>(Tobs,<span class="fl">0.975</span>)</span>
<span id="cb67-30"><a href="#cb67-30" tabindex="-1"></a>L<span class="ot">&lt;-</span>correlation<span class="sc">-</span>t2<span class="sc">*</span>se</span>
<span id="cb67-31"><a href="#cb67-31" tabindex="-1"></a>U<span class="ot">&lt;-</span>correlation<span class="sc">-</span>t1<span class="sc">*</span>se</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>L</span></code></pre></div>
<pre><code>##      97.5% 
## -0.3373324</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>U</span></code></pre></div>
<pre><code>##      2.5% 
## 0.9785937</code></pre>
<p>So the bootstrap t confidence interval is [-0.3373,0.9786]</p>
</div>
<div id="hw5" class="section level2">
<h2><strong>HW5</strong></h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap conﬁdence intervals for
the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal,
basic, percentile, and BCa methods. Compare the intervals and explain
why they may differ.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">return</span>(<span class="fu">mean</span>(x[i]))</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>{</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>    de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>d,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>    ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>output<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">2</span>])),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;BCa&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Lower bound&quot;</span>,<span class="st">&quot;Upper bound&quot;</span>)))</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##       Lower bound Upper bound
## norm     34.44374    181.7806
## basic    24.83158    169.5083
## perc     46.65833    191.3351
## BCa      56.93390    228.3469</code></pre>
<p>From the result, we can see that basic CI is the smallest intervel
with respect to the value of lower bound and upper bound. Maybe it’s
because the method use the bootstrap sample quantile to replace the
population quantile and the bootstrap sample quantile maybe larger than
that. Note that the percentile CI and BCa CI is also larger than the
norm CI, maybe it’s because the sample is obviously follow a non-normal
distribution, and using a normal distribution maybe unsuitable. Compare
the percentile CI and BCa CI, the BCa CI has a correction compare to the
percentile CI, and from the distribution of the sample, we can see that
the skewness of it’s distribution is 1.71, it’s larger than 0, the BCa
CI is larger than the percentile CI.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="fu">data</span>(scor)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>SIGMA<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(SIGMA)<span class="sc">$</span>values</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">max</span>(lambda)<span class="sc">/</span><span class="fu">sum</span>(lambda)</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>es<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(n)</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>{</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  scor_j<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>  sigma_j<span class="ot">&lt;-</span><span class="fu">cov</span>(scor_j)</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>  lambda_j<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma_j)<span class="sc">$</span>values</span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  es[i]<span class="ot">&lt;-</span><span class="fu">max</span>(lambda_j)<span class="sc">/</span><span class="fu">sum</span>(lambda_j)</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>}</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>je<span class="ot">&lt;-</span><span class="fu">mean</span>(es)</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(je<span class="sc">-</span>theta)</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(es))</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>output<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(bias,sd),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;bias&quot;</span>,<span class="st">&quot;sd&quot;</span>)))</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##             [,1]
## bias 0.001069139
## sd   0.049836277</code></pre>
<p>So the jackknife estimates of bias and standard error is 0.001069139
and 0.049836277</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best ﬁtting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p>Using the following procedure to estimate prediction error by
leave-two-out cross validation.</p>
<p>Step1:For k = 1, . . . , n, let observation <span class="math inline">\((x_k, y_k)\)</span> be the test point and use the
remaining observations to ﬁt the model. (a) Fit the model(s) using only
the n − 2 observations in the training set, <span class="math inline">\((x_i, y_i)\)</span>, <span class="math inline">\(i
\ne k\)</span>. (b) Compute the predicted response <span class="math inline">\(\hat{y}_k = \hat{\beta}_0 +
\hat{\beta}_1x_k\)</span> for the test point. (c) Compute the prediction
error <span class="math inline">\(e_k = y_k − \hat{y}_k\)</span>.
Step2:Estimate the mean of the squared prediction errors <span class="math inline">\(\hat{\sigma}_{\epsilon}^2=\frac{1}{n}\sum_{k=1}^ne_k^2\)</span></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: package &#39;DAAG&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>M<span class="ot">&lt;-</span>n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) </span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>{</span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>  {</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>    index<span class="ot">&lt;-</span><span class="fu">c</span>(i,j)</span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>index]</span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>index]</span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[index]</span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>    e1[(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">-</span>i)<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i]<span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[index] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[index] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[index]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>    e2[(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">-</span>i)<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i]<span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[index] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[index]</span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb82-24"><a href="#cb82-24" tabindex="-1"></a>    e3[(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">-</span>i)<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i]<span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[index] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-25"><a href="#cb82-25" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb82-26"><a href="#cb82-26" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[index])</span>
<span id="cb82-27"><a href="#cb82-27" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb82-28"><a href="#cb82-28" tabindex="-1"></a>    e4[(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">-</span>i)<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i]<span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[index] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-29"><a href="#cb82-29" tabindex="-1"></a>  }</span>
<span id="cb82-30"><a href="#cb82-30" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic
model,would be the best ﬁt for the data.</p>
</div>
<div id="hw6" class="section level2">
<h2><strong>HW6</strong></h2>
</div>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>If <span class="math inline">\(f(r)g(s|r)&lt;f(s)g(r|s)\)</span>,
then<span class="math display">\[\alpha(r,s)=1\]</span>,<span class="math display">\[\alpha(s,r)=\frac{f(r)g(s|r)}{f(s)g(r|s)}\]</span>.If
<span class="math inline">\(f(r)g(s|r)\geq f(s)g(r|s)\)</span>,
then<span class="math display">\[\alpha(r,s)=\frac{f(s)g(r|s)}{f(r)g(s|r)}\]</span>,<span class="math display">\[\alpha(s,r)=1\]</span>. Hence, when<span class="math inline">\(f(r)g(s|r)&lt;f(s)g(r|s)\)</span>, we can see that
<span class="math display">\[\begin{aligned}
K(s,r)f(s)&amp;=(\alpha(s,r)g(r|s)+I(r=s)[1-\int\alpha(s,r)g(r|s)])f(s)\\
&amp;=\frac{f(r)g(s|r)}{f(s)g(r|s)}f(s)g(r|s)+I(r=s)[f(s)-\int\frac{f(r)g(s|r)}{f(s)g(r|s)}g(r|s)f(s)]\\&amp;=
f(r)g(s|r)+I(r=s)[f(s)-\int f(r)g(s|r)]
\end{aligned}\]</span> <span class="math display">\[\begin{aligned}
K(r,s)f(r)&amp;=(\alpha(r,s)g(s|r)+I(s=r)[1-\int\alpha(r,s)g(s|r)])f(r)\\
&amp;=f(r)g(s|r)+I(s=r)[f(r)-\int g(s|r)f(r)]\\
&amp;=K(s,r)f(s)
\end{aligned}\]</span> when<span class="math inline">\(f(r)g(s|r)\geq
f(s)g(r|s)\)</span>, we can see that <span class="math display">\[\begin{aligned}
K(s,r)f(s)&amp;=(\alpha(s,r)g(r|s)+I(r=s)[1-\int\alpha(s,r)g(r|s)])f(s)\\
&amp;=f(s)g(r|s)+I(r=s)[f(s)-\int g(r|s)f(s)]\\
\end{aligned}\]</span> <span class="math display">\[\begin{aligned}
K(r,s)f(r)&amp;=(\alpha(r,s)g(s|r)+I(s=r)[1-\int\alpha(r,s)g(s|r)])f(r)\\
&amp;=\frac{f(s)g(r|s)}{f(r)g(s|r)}f(r)g(s|r)+I(s=r)[f(r)-\int\frac{f(s)g(r|s)}{f(r)g(s|r)}g(s|r)f(r)]\\&amp;=
f(s)g(r|s)+I(s=r)[f(r)-\int f(s)g(r|s)]\\
&amp;=K(s,r)f(s)
\end{aligned}\]</span>.That’s to say <span class="math inline">\(K(r,s)f(r)=K(s,r)f(s)\)</span>.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>In the example 8.1.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x,xs)</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>{</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(xs)</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>  numx<span class="ot">&lt;-</span><span class="fu">numeric</span>(num)</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(num))</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a>  {</span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>     numx[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(x<span class="sc">&lt;=</span>xs[i])<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>  }</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>  <span class="fu">return</span>(numx)</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>}</span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(y,ys)</span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>{</span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a>  n0<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a>  n1<span class="ot">&lt;-</span><span class="fu">length</span>(ys)</span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>  numy<span class="ot">&lt;-</span><span class="fu">numeric</span>(n1)</span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n1))</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>  {</span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>    numy[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(y<span class="sc">&lt;=</span>ys[i])<span class="sc">/</span>n0</span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a>  }</span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a>  <span class="fu">return</span>(numy)</span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a>}</span>
<span id="cb85-26"><a href="#cb85-26" tabindex="-1"></a>W<span class="ot">&lt;-</span><span class="cf">function</span>(x,y)</span>
<span id="cb85-27"><a href="#cb85-27" tabindex="-1"></a>{</span>
<span id="cb85-28"><a href="#cb85-28" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb85-29"><a href="#cb85-29" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb85-30"><a href="#cb85-30" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb85-31"><a href="#cb85-31" tabindex="-1"></a>  N<span class="ot">&lt;-</span>m<span class="sc">+</span>n</span>
<span id="cb85-32"><a href="#cb85-32" tabindex="-1"></a>  W<span class="ot">=</span><span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb85-33"><a href="#cb85-33" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>)</span>
<span id="cb85-34"><a href="#cb85-34" tabindex="-1"></a>  {</span>
<span id="cb85-35"><a href="#cb85-35" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb85-36"><a href="#cb85-36" tabindex="-1"></a>  Z<span class="ot">&lt;-</span>z[index]</span>
<span id="cb85-37"><a href="#cb85-37" tabindex="-1"></a>  xp<span class="ot">&lt;-</span>Z[<span class="dv">1</span><span class="sc">:</span>m]</span>
<span id="cb85-38"><a href="#cb85-38" tabindex="-1"></a>  yp<span class="ot">&lt;-</span>Z[(m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb85-39"><a href="#cb85-39" tabindex="-1"></a>  W[i]<span class="ot">&lt;-</span>m<span class="sc">*</span>n<span class="sc">*</span>(<span class="fu">sum</span>((<span class="fu">f</span>(x,xp)<span class="sc">-</span><span class="fu">g</span>(y,xp))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">f</span>(x,yp)<span class="sc">-</span><span class="fu">g</span>(y,yp))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>((m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb85-40"><a href="#cb85-40" tabindex="-1"></a>  }</span>
<span id="cb85-41"><a href="#cb85-41" tabindex="-1"></a>  wobs<span class="ot">&lt;-</span>m<span class="sc">*</span>n<span class="sc">*</span>(<span class="fu">sum</span>((<span class="fu">f</span>(x,x)<span class="sc">-</span><span class="fu">g</span>(y,x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">f</span>(x,y)<span class="sc">-</span><span class="fu">g</span>(y,y))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>((m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb85-42"><a href="#cb85-42" tabindex="-1"></a>  p_value<span class="ot">&lt;-</span><span class="fu">sum</span>(W<span class="sc">&gt;</span>wobs)<span class="sc">/</span><span class="dv">10000</span></span>
<span id="cb85-43"><a href="#cb85-43" tabindex="-1"></a>  <span class="fu">return</span>(p_value)</span>
<span id="cb85-44"><a href="#cb85-44" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">W</span>(x1,x3)</span></code></pre></div>
<pre><code>## [1] 0.2598</code></pre>
<p>We can see that the p-value is larger than 0.05, so we can reject H0
at 0.05 significance level.</p>
<p>In the example 8.2</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]))</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="fu">W</span>(x2,x3)</span></code></pre></div>
<pre><code>## [1] 0.051</code></pre>
<p>We can see taht the p-value is 0.0572, it’s slightlt larger than
0.05.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
</div>
<div id="answer3-1" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>count5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>}</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>countp<span class="ot">&lt;-</span><span class="cf">function</span>(x,y)</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a>{</span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">length</span>(z)</span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a>  stats<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">199</span>,<span class="at">expr=</span>{</span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>    index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a>    k1<span class="ot">&lt;-</span>index[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a>    k2<span class="ot">&lt;-</span>index[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a>    <span class="fu">count5</span>(z[k1],z[k2])</span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a>  })</span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a>  stat<span class="ot">&lt;-</span><span class="fu">count5</span>(x,y)</span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a>  as<span class="ot">&lt;-</span><span class="fu">c</span>(stats,stat)</span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate=</span>stat,<span class="at">p=</span><span class="fu">mean</span>(as<span class="sc">&gt;=</span>stat)))</span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s see the example when variance is equal</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a><span class="fu">countp</span>(x,y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 7
## 
## $p
## [1] 0.115</code></pre>
<p>From the result, we can see that we do not reject H0, the observed
statistics is not significant.</p>
<p>When the variance are unequal,</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="fu">countp</span>(x,y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 16
## 
## $p
## [1] 0.005</code></pre>
<p>We can see that the result statistics is significant.</p>
</div>
<div id="hw7" class="section level2">
<h2><strong>HW7</strong></h2>
</div>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>Consider a model <span class="math inline">\(P(Y = 1 | X1, X2, X3) =
\frac{exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>,where
<span class="math inline">\(X_1 ∼ P(1)\)</span>, <span class="math inline">\(X_2 ∼ Exp(1)\)</span>and <span class="math inline">\(X_3 ∼ B(1, 0.5).\)</span> • Design a function that
takes as input values N, <span class="math inline">\(b_1,\  b_2,\  b_3\)</span> and <span class="math inline">\(f_0\)</span>, and produces the output a. • Call
this function, input values are N = 106, <span class="math inline">\(b_1\)</span> = 0, <span class="math inline">\(b_2\)</span> = 1, <span class="math inline">\(b_3\)</span> = −1, <span class="math inline">\(f_0\)</span> = 0.1, 0.01, 0.001, 0.0001. • Plot −
log <span class="math inline">\(f_0\)</span> vs a.</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0)</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>{</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  x3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>  g<span class="ot">&lt;-</span><span class="cf">function</span>(alpha)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  {</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>      tmp<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>      p<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>      <span class="fu">mean</span>(p)<span class="sc">-</span>f0</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  }</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  solution<span class="ot">&lt;-</span><span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>alpha1<span class="ot">&lt;-</span><span class="fu">alpha</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>alpha2<span class="ot">&lt;-</span><span class="fu">alpha</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>alpha3<span class="ot">&lt;-</span><span class="fu">alpha</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.001</span>)</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>alpha4<span class="ot">&lt;-</span><span class="fu">alpha</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.0001</span>)</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a><span class="fu">c</span>(alpha1,alpha2,alpha3,alpha4)</span></code></pre></div>
<pre><code>## [1]  -3.166844  -6.070743  -8.713208 -11.268088</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.5</span>,<span class="fl">0.01</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(f0)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>{</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">alpha</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,f0[i])</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>}</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),y)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmADpmtv+QOgCQZgCQkGaQ2/+2ZgC2tma225C2/7a2///bkDrb////tmb/25D//7b//9v///+RlWzTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG0UlEQVR4nO2dC1fjNhBGTWBLurRkW4w3+P//0FqSnZiHc5Wgx7j+7jlwOOBIzmU0kpKx0/TiIk3tE7COBAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEFAYkHNaqglaLSUttUM1BTUrMFQRUHNKgzVFNT0Vw3yOlQVdGUarELVHLQGQ7VnMfOGbAgybKiqoDUYqitoBYYqC7JvqLYg84YyCWqHJ/zT/7B7geaMG8ojqL177o/7hz5GkHFDWQS9PT367/evMYJGQ0b3ZVkEHfd+ePWH+9cYQX3wY9NQxggaODxECeqnCDKoKFMOGrUc902UoPkLjNf0U4Bss1gYZG9P7wUtejBrqPo66Pwbm4ZyCjqlorjmbBoyJGg23RtyZEnQfLo3Y8iUoL4/GTITQ8YE2UtEdmax6Q/GNh7mBI3jK4yztH3ehD1BUwYyEkUGBY3vuYaEXd2QSUGnFZGBGLIpaIoeAzFkVNBJUfUYMitoVBOydUUMC5qip+58b1pQP033FbdmtgWN0VNzNjMuaFoS1QuiwoKu34uOr300yf9Fsf0nPzB5c1P41EnWKxA0JaAm/VnEdJ78wBzNnd0UN7QOQefhVXycrURQP4+goobWI6jSOFuRoNk4S3sulztNfmDW5iQo5nHjoijh2UCHaQ/M3Ny4w/9OE9f1l/zAEs0VHGkSFNVVygM9h91L//tH09w9J2nu60evWJD388fzuVrxe819/XCrOei4bx7g2OP+0dUnuh/b+9fv9bt0OpZnMVclvlyW0Ie4GSsXurgaRbvcOMTAkYueNmsEvW8sYzjdnIOcooXocCG0e/Eh1C1l6ZTPKGtCuk1Q17hLMXwp/QJdeGH1Y7bKUf6Td0q7QdCQpZtgZinBpOw3tik7go77xcXNB26pMLsBa4LiKSTIYg6Ko5Qgm7NYBMUE5USCgHXu5gsiQYAEARIESBAgQYAEARIESBAgQYAEARIEFBZk7opLRBEESBAgQYAEARIESBAgQYAEAZkEvT2F5eDie9MbF9ROtTHdUpHMtgXN3hArUh+UkyyCZpWJW60wu4wiiJjuEqgctIQrsnIslqBtXVDp5vIhQYAEAXrJFci0DjqL0DroKz7eBPibzdUk22YVLnjZuqBhhbhwHdRtzdVDsxggQYDKgAEJAiRoidldi+KOv76LVQtqZl/RD7iSNQtqpu+axb5GggAJIkrkoILNZaDALFawuXxUE7QaKglK0Fnhg4o0krQzCbJ1UJFGknYmQbYOKtJI0s4kyNZBRRpJ2pkE2TqoSCP/ZyQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAooJ8hcrXryf98hh+V7EI+6u+nT3dH/f58v1lHGUEvT2dPc8nDQ+r75bvlJmOmI44LiHltqhO6o4jaKUoN8/3Mm2eCPm454EheobaCnUKx/4/4GUzUGLdzI/0d7/BYL8xzIQaxV0oAganj3loG73756z2eqGmGfxQsUJN3xIUOuuE8GSf3dz+dg7iF+kpKAOc7S7FBYF+edNt5UPnyETM2sCBQVh/IT0goK8mpD0l1uKnBOYcoJaXgW1Y2nKxeceYgdSdZgNeE5giglqYzMmRVC4eh+GWIigb3y8w4ly66DYfIAraZeoLpUih1bWloPG0RMR87zV6GI2LYfInQ2hzSogQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEAdYEzT55Yc7b00/39v7jVDh2/DNF9VgMKxHUPgx/eQwVP77qp8MSh0SsQ5D7rfsKVS+ueNWFVBFMCjrVtxyGAfW3C5rdiyuv3/1zrqxb+mSP1FgU5Mp3fSm9q4LqXM5xMeP+EgrvfOFYivK6GAwKCuNoEBDq6A53zz79eHXn0kOo4kyGQUHhqQ/fQ4lh5wT9/CTISyuAWUHDD+0kyP/mwxDboCBXxvh4OYJm5c8bFOT5nIPaWQ46T/NbzkEXZrHzQnHLs9j7ddDul7M0fIUlZDuVEm91HfSZs5w5C1uS9FgWNE5e/gLDj9cJbXYv9o7udGXLx63Xdnfz5pAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCPgP8flL4VZLn4oAAAAASUVORK5CYII=" /><!-- --></p>
<p>##Question 2:9.4</p>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
</div>
<div id="answer2-1" class="section level2">
<h2>Answer2</h2>
<p>The density function of the standard Laplace distribution is<span class="math inline">\(f(x)=\frac{1}{2}e^{|x|}\)</span>. Using a random
walk Metropolis sampler, the proposal distribution is <span class="math inline">\(N(x_t,\sigma^2)\)</span>. So the acceptance rate
can be recognized as <span class="math display">\[\alpha(y,x_t)=min(\frac{e^{-|y|+\frac{(x_t-y)^2}{\sigma^2}}}{e^{-|x_t|+\frac{(y-x_t)^2}{\sigma^2}}},1)=min(e^{|x_t|-|y|},1)\]</span>.
Then using the following algorithm, we can see the generated chains.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="cf">function</span>(N,x0,sigma)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>{</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">=</span>x0</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(N)</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>  r<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>  {</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>    alpha<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fu">abs</span>(y))</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span>alpha)</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>    {</span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>      x[i]<span class="ot">=</span>x[i<span class="dv">-1</span>]</span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a>      r<span class="ot">=</span>r<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a>    }</span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a>  }</span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">r=</span>r))</span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">8000</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>M1<span class="ot">&lt;-</span><span class="fu">M</span>(N,x0,sigma[<span class="dv">1</span>])</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>M2<span class="ot">&lt;-</span><span class="fu">M</span>(N,x0,sigma[<span class="dv">2</span>])</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>M3<span class="ot">&lt;-</span><span class="fu">M</span>(N,x0,sigma[<span class="dv">3</span>])</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>M4<span class="ot">&lt;-</span><span class="fu">M</span>(N,x0,sigma[<span class="dv">4</span>])</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>M5<span class="ot">&lt;-</span><span class="fu">M</span>(N,x0,sigma[<span class="dv">5</span>])</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>M6<span class="ot">&lt;-</span><span class="fu">M</span>(N,x0,sigma[<span class="dv">6</span>])</span></code></pre></div>
<p>The rejection rate is showed as following.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(M1<span class="sc">$</span>r,M2<span class="sc">$</span>r,M3<span class="sc">$</span>r,M4<span class="sc">$</span>r,M5<span class="sc">$</span>r,M6<span class="sc">$</span>r)<span class="sc">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.018875 0.168250 0.311375 0.473875 0.708375 0.836375</code></pre>
<p>From the result, we can see that the forth chain’s rejection region
is close to 0.5.</p>
<p>Besides, choose the first 1000 sample as the burn-in sample, let’s
see the generated chain.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>MN1<span class="ot">&lt;-</span>M1<span class="sc">$</span>x[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>MN2<span class="ot">&lt;-</span>M2<span class="sc">$</span>x[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>MN3<span class="ot">&lt;-</span>M3<span class="sc">$</span>x[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>MN4<span class="ot">&lt;-</span>M4<span class="sc">$</span>x[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>MN5<span class="ot">&lt;-</span>M5<span class="sc">$</span>x[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>MN6<span class="ot">&lt;-</span>M6<span class="sc">$</span>x[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a><span class="fu">plot</span>(MN1,<span class="at">type=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a><span class="fu">plot</span>(MN2,<span class="at">type=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a><span class="fu">plot</span>(MN3,<span class="at">type=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a><span class="fu">plot</span>(MN4,<span class="at">type=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a><span class="fu">plot</span>(MN5,<span class="at">type=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb103-14"><a href="#cb103-14" tabindex="-1"></a><span class="fu">plot</span>(MN6,<span class="at">type=</span><span class="st">&#39;o&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the forth chain, when <span class="math inline">\(\sigma=2\)</span>,has a better convergence.</p>
</div>
<div id="question-39.7" class="section level2">
<h2>Question 3:9.7</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9. Plot
the generated sample after discarding a suitable burn-in sample. Fit a
simple linear regression model Y = β0 + β1X to the sample and check the
residuals of the model for normality and constant variance.</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<p>The target distribution is bivariate normal<span class="math inline">\((X_1,X_2)\sim N(0,0,1,1,0.9)\)</span>. And the
conditional distributions <span class="math inline">\(f(x_1|x_2)\)</span> and <span class="math inline">\(f(x_2|x_1)\)</span> is <span class="math display">\[(X_1|X_2)\sim N(0.9X_2,0.19)\]</span>,<span class="math display">\[(X_2|X_1)\sim N(0.9X_1,0.19)\]</span></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">8000</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>x1<span class="ot">&lt;-</span>x2<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>{</span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>  x2<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>x2,<span class="fl">0.19</span>)</span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>x1,<span class="fl">0.19</span>)</span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>  X[i,]<span class="ot">&lt;-</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>XN<span class="ot">&lt;-</span>X[(B<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>x<span class="ot">&lt;-</span>XN[,<span class="dv">1</span>]</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>y<span class="ot">&lt;-</span>XN[,<span class="dv">2</span>]</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x)</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">summary</span>(L)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62982 -0.12745  0.00275  0.12748  0.68074 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0001336  0.0022600   0.059    0.953    
## x           0.8881260  0.0053019 167.512   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.189 on 6998 degrees of freedom
## Multiple R-squared:  0.8004, Adjusted R-squared:  0.8004 
## F-statistic: 2.806e+04 on 1 and 6998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can see that the estimated parameter fits the target distribution
very well. Their correlation is very close to 0.9.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)   </span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">plot</span>(y,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;random numbers&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">4</span>)</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">bty=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-49.10" class="section level2">
<h2>Question 4:9.10</h2>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2. (See Exercise 9.9.)
Also use the coda [212] package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions gelman.diag, gelman.plot, as.mcmc, and mcmc.list.</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>{</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) </span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>    <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,m,x0)</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>{</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) </span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  {</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) </span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y </span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a>    {</span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a>    }</span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a>  }</span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) </span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>{</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span>sigma,sigma,sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,k,m)</span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a>{</span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a>  X[i,]<span class="ot">&lt;-</span><span class="fu">chain</span>(sigma,m,x0[i])</span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a>}</span>
<span id="cb114-10"><a href="#cb114-10" tabindex="-1"></a>psi<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb114-11"><a href="#cb114-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb114-12"><a href="#cb114-12" tabindex="-1"></a>  psi[i,]<span class="ot">&lt;-</span>psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb114-13"><a href="#cb114-13" tabindex="-1"></a>rhat<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb114-14"><a href="#cb114-14" tabindex="-1"></a>rhat</span></code></pre></div>
<pre><code>## [1] 1.912835</code></pre>
<p>We can also use the Gelman-Rubin functions in coda.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">1</span>,])</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">2</span>,])</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>X3<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">3</span>,])</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>X4<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">4</span>,])</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">mcmc.list</span>(X1,X2,X3,X4)</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(Y))</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.02</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(Y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw8" class="section level2">
<h2><strong>HW8</strong></h2>
</div>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>设<span class="math inline">\(X_1,...,X_n\sim
Exp(\lambda).\)</span>因为某种原因，只知道<span class="math inline">\(X_i\)</span>存在某个区间<span class="math inline">\((u_i,v_i)\)</span>,其中<span class="math inline">\(u_i&lt;v_i\)</span>是两个非随机的已知常数，这种数据被称为区间删失数据。</p>
<p>（1）试分别直接极大化观测数据的似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，证明EM算法收敛于观测数据的MLE，且收敛有线性速度。</p>
<p>（2）设<span class="math inline">\((u_i,v_i),i=1,...,n\)</span>的观测值为<span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\)</span>试分别编程实现上述两种算法以得到<span class="math inline">\(\lambda\)</span>的MLE数值解。</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>For the MLE estimator : consider <span class="math display">\[P_\lambda(u_i&lt;X_i&lt;v_i)=\int_{u_i}^{v_i}xdx=e^{-\lambda
u_i}-e^{-\lambda v_i}\]</span> The likelihood of the observed data is
<span class="math display">\[L(\lambda)=\prod_{i=1}^nP_\lambda(u_i&lt;X_i&lt;v_i)\]</span>
So the log-likelihood is <span class="math display">\[l(\lambda)=\sum_{i=1}^nlog(e^{-\lambda
u_i}-e^{-\lambda
v_i})=-\lambda(\sum_{i=1}^nv_i)+\sum_{i=1}^nlog(e^{\lambda
(v_i-u_i)}-1)\]</span> Hence <span class="math display">\[\frac{dl}{d\lambda}=-\sum_{i=1}^nu_i+\sum_{i=1}^n\frac{v_i-u_i}{e^{\lambda(v_i-u_i)}-1}\]</span>
The MLE estimator of the parameter <span class="math inline">\(\hat{\lambda}\)</span> satisfies that <span class="math display">\[\frac{dl}{d\lambda}|_{\hat{\lambda}}=0\]</span></p>
<p>For the EM algorithm: the procedure can be as following. Denote <span class="math inline">\(Z_i\)</span> as the observed data and <span class="math inline">\(X_i\)</span> as the true data.</p>
<p>The E step can be <span class="math display">\[E(log(\textbf{X}|\lambda)|\lambda_t,\textbf{Z})=E(nlog(\lambda)-\sum_{i=1}^n\lambda
X_i|\lambda_t.\textbf{Z})\]</span> Note that <span class="math display">\[E(X_i|\lambda_t,Z_i)=\frac{(u_i+\frac{1}{\lambda_t})e^{-\lambda_t
u_i}-(v_i+\frac{1}{\lambda_t})e^{-\lambda_t v_i}}{e^{-\lambda_t
u_i}-e^{-\lambda_t v_i}}\]</span> That’s to say the condotional
expectation is <span class="math display">\[E(log(\lambda|\textbf{X})|\textbf{Z})=nlog(\lambda)-\lambda\sum_{i=1}^n\frac{(u_i+\frac{1}{\lambda_t})e^{-\lambda_t
u_i}-(v_i+\frac{1}{\lambda_t})e^{-\lambda_t v_i}}{e^{-\lambda_t
u_i}-e^{-\lambda_t v_i}}\]</span></p>
<p>The M step: maximize the conditional expectation. The <span class="math display">\[\frac{1}{\lambda_{t+1}}=\frac{1}{n}\sum_{i=1}^n\frac{(u_i+\frac{1}{\lambda_t})e^{-\lambda_t
u_i}-(v_i+\frac{1}{\lambda_t})e^{-\lambda_t v_i}}{e^{-\lambda_t
u_i}-e^{-\lambda_t v_i}}\]</span></p>
<p>As for the convergence rate of the EM algorithm, we can see that the
iteration function is <span class="math display">\[f(x)=\frac{n}{\sum_{i=1}^n\frac{(u_i+\frac{1}{x})e^{-x
u_i}-(v_i+\frac{1}{x})e^{-x v_i}}{e^{-x u_i}-e^{-x v_i}}}\]</span>
Consider<span class="math display">\[(u_i+\frac{1}{x})e^{-x
u_i}-(v_i+\frac{1}{x})e^{-x v_i}=-x\epsilon_ie^{-x\epsilon_i}(u_i-v_i)\
\ \ \ where\  \epsilon_i\ is\ between\ u_i\ and\ v_i\]</span> <span class="math display">\[e^{-\lambda_t u_i}-e^{-\lambda_t
v_i}=-x\eta_ie^{-x}(u_i-v_i)\ \ \ \ where\  \eta_i\ is\ between\ u_i\
and\ v_i\]</span> So <span class="math display">\[f(x)=\frac{n}{\sum_{i=1}^n\epsilon_ie^{(\eta_i-\epsilon_i)x}}\]</span>
Denote the maximum of <span class="math inline">\(\{\epsilon_ie^{(\eta_i-\epsilon_i)x}\}_{i=1}^n\)</span>
as <span class="math inline">\(\epsilon e^{(\eta-\epsilon)x}\)</span>,
the minimum of the sequence is <span class="math inline">\(\epsilon^{&#39;}e^{(\eta^{&#39;}-\epsilon^{&#39;})x}\)</span>.
Hence, we can see that <span class="math display">\[\frac{1}{\epsilon^{&#39;}e^{(\eta^{&#39;}-\epsilon^{&#39;})x}}\le
f(x)\le \frac{1}{\epsilon e^{(\eta-\epsilon)x}}\]</span> The value of
<span class="math inline">\(\epsilon\)</span> and <span class="math inline">\(\eta\)</span> depend on x.</p>
<p>Then <span class="math display">\[|f(y)-f(x)|\le
max\{|\frac{1}{\epsilon_x^{&#39;}e^{(\eta_x^{&#39;}-\epsilon_x^{&#39;})x}}-\frac{1}{\epsilon_y
e^{(\eta_y-\epsilon_y)y}}|,|\frac{1}{\epsilon_y
e^{(\eta_y)y}}-\frac{1}{\epsilon_x^{&#39;}e^{(\eta_x^{&#39;}-\epsilon_x^{&#39;})x|}}
\}\]</span> Besides, note that <span class="math inline">\(--\epsilon
l:=min\{u_i-v_i\}\le\eta-\epsilon \le max\{v_i-u_i\}:=l\)</span>, we can
find that when controling x and y in the range (0,1), ans assuming that
x&lt;y, then <span class="math display">\[|f(x)-f(y)|\le|\frac{1}{min\{u_i\}}e^{\lambda
x}-\frac{1}{max\{v_i\}}e^{-\lambda y}|\le|\frac{1}{min\{u_i\}}e^{\lambda
x-\lambda y}-\frac{1}{max\{v_i\}}e^{-2\lambda y}||e^{\lambda y}|\le
e^{\lambda}(\frac{10}{min\{u_i\}}\lambda(x-y)+\frac{1}{min\{u_i\}})\]</span>
That’s to say, there exists a constant K that satisfies when <span class="math inline">\(x,y\in(0,1)\)</span>,<span class="math display">\[|f(x)-f(y)|\le K|x-y|\]</span> So we can get that
the EM algorithm convergences to the MLE of the observed data since the
MLE is in the range (0,1). Besides, we have when <span class="math inline">\(x\in(0,1)\)</span> <span class="math display">\[|f^{&#39;}(x)|=|\frac{-n\sum_{i=1}^n\epsilon_i(\epsilon_i-\eta_i)e^{(\eta_i-\epsilon_i)x}}{(\sum_{i=1}^n\epsilon_ie^{(\eta_i-\epsilon_i)x})^2}|&lt;\infty\]</span>
That’s to say, the EM algorithm have a linear convergence rate.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span></code></pre></div>
<p>For the MLE method</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a>mle<span class="ot">&lt;-</span><span class="cf">function</span>(lambda)</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>{</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(v)</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>  b<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>  {</span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>    b<span class="ot">=</span>b<span class="sc">+</span>(v[i]<span class="sc">-</span>u[i])<span class="sc">/</span>(<span class="fu">exp</span>(lambda<span class="sc">*</span>(v[i]<span class="sc">-</span>u[i]))<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a>  }</span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>  b<span class="ot">=</span>b<span class="sc">-</span><span class="fu">sum</span>(u)</span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">uniroot</span>(mle,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## $root
## [1] 0.07196172
## 
## $f.root
## [1] 0.02272859
## 
## $iter
## [1] 9
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<p>The MLE result is 0.07196.</p>
<p>If we use the EM algorithm</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>EM<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>{</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(v)</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a>  {</span>
<span id="cb123-7"><a href="#cb123-7" tabindex="-1"></a>    t<span class="ot">=</span>t<span class="sc">+</span>((u[i]<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>x)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>u[i])<span class="sc">-</span>(v[i]<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>x)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>v[i]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>u[i])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>v[i]))</span>
<span id="cb123-8"><a href="#cb123-8" tabindex="-1"></a>  }</span>
<span id="cb123-9"><a href="#cb123-9" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">/</span>t)</span>
<span id="cb123-10"><a href="#cb123-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">EM</span>(x)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>t<span class="ot">&lt;-</span>(y<span class="sc">-</span>x)</span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(t)<span class="sc">&gt;</span><span class="fl">1e-5</span>)</span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a>{</span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a>  x<span class="ot">&lt;-</span>y</span>
<span id="cb124-8"><a href="#cb124-8" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">EM</span>(x)</span>
<span id="cb124-9"><a href="#cb124-9" tabindex="-1"></a>  t<span class="ot">&lt;-</span>(y<span class="sc">-</span>x)</span>
<span id="cb124-10"><a href="#cb124-10" tabindex="-1"></a>  n<span class="ot">=</span>n<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb124-11"><a href="#cb124-11" tabindex="-1"></a>}</span>
<span id="cb124-12"><a href="#cb124-12" tabindex="-1"></a><span class="fu">c</span>(y,n)</span></code></pre></div>
<pre><code>## [1] 0.0719735 2.0000000</code></pre>
<p>We can see that the result we gain from the EM algorithm is equal to
the MLE.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoﬀ matrix, or a
positive constant is multiplied times every entry of the payoﬀ matrix.
However, the simplex algorithm may terminate at a diﬀerent basic
feasible point (also optimal). Compute B &lt;- A + 2, ﬁnd the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also ﬁnd the value of game A and
game B.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb127-10"><a href="#cb127-10" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb127-11"><a href="#cb127-11" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb127-12"><a href="#cb127-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb127-13"><a href="#cb127-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb127-14"><a href="#cb127-14" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb127-15"><a href="#cb127-15" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb127-16"><a href="#cb127-16" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb127-17"><a href="#cb127-17" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb127-18"><a href="#cb127-18" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb127-19"><a href="#cb127-19" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb127-20"><a href="#cb127-20" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb127-21"><a href="#cb127-21" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb127-22"><a href="#cb127-22" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb127-23"><a href="#cb127-23" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb127-24"><a href="#cb127-24" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb127-25"><a href="#cb127-25" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb127-26"><a href="#cb127-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb127-27"><a href="#cb127-27" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb127-28"><a href="#cb127-28" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb127-29"><a href="#cb127-29" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb127-30"><a href="#cb127-30" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb127-31"><a href="#cb127-31" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb127-32"><a href="#cb127-32" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb127-33"><a href="#cb127-33" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb127-34"><a href="#cb127-34" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb127-35"><a href="#cb127-35" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb127-36"><a href="#cb127-36" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb127-37"><a href="#cb127-37" tabindex="-1"></a>soln</span>
<span id="cb127-38"><a href="#cb127-38" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>B<span class="ot">&lt;-</span>A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>sb<span class="ot">&lt;-</span><span class="fu">solve.game</span>(B)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>sa<span class="ot">&lt;-</span><span class="fu">solve.game</span>(A)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>sa<span class="sc">$</span>v</span></code></pre></div>
<pre><code>## x10 
##   0</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>sb<span class="sc">$</span>v</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(sb<span class="sc">$</span>x,sb<span class="sc">$</span>y),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(sa<span class="sc">$</span>x,sa<span class="sc">$</span>y),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">round</span>(sb<span class="sc">$</span>x<span class="sc">*</span><span class="dv">61</span>,<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">round</span>(sa<span class="sc">$</span>x<span class="sc">*</span><span class="dv">61</span>,<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<p>We can find that the value of the game B is 2, the value of game A is
0. And the simplex algotithm terminated at the extreme point given by
(11.15)</p>
</div>
<div id="hw9" class="section level2">
<h2><strong>HW9</strong></h2>
</div>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>2.1.3 Exercise4 :Why do you need to use unlist() to convert a list to
an atomic vector? Why doesn’t as.vector() work?</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<p>A list is already a vector, though not an atomic one!</p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>2.3.1 Exercise 1:What does dim() return when applied to a vector?</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<p>It returns NULL when the function applied to a vector.</p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>2.3.1 Exercise 2:If is.matrix(x) is TRUE, what will is.array(x)
return?</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<p>It also returns TRUE</p>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>2.4.5 Exercise 2:What does as.matrix() do when applied to a data
frame with columns of diﬀerent types?</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<p>The result given by the function as.matrix() depend on the types of
the input columns and it follows the usual coercion hierarchy (logical
&lt; integer &lt; double &lt; complex). For example, all-logical data
frames will be coerced to a logical matrix, mixed logical-integer will
give an integer matrix, etc.</p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>2.4.5 Exercise 3:Can you have a data frame with 0 rows? What about 0
columns?</p>
</div>
<div id="answer-5-1" class="section level2">
<h2>Answer 5</h2>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">integer</span>(),<span class="at">b=</span><span class="fu">logical</span>())</span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="fu">dim</span>(d1)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<p>This is a dataframe with 0 row and 2 columns.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a><span class="fu">dim</span>(d2)</span></code></pre></div>
<pre><code>## [1] 3 0</code></pre>
<p>This is a dataframe with 3 rows and 0 column.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>d3<span class="ot">&lt;-</span><span class="fu">data.frame</span>()</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a><span class="fu">dim</span>(d3)</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<p>This is a dataframe with 0 row and 0 column.</p>
</div>
<div id="question-6" class="section level2">
<h2>Question 6</h2>
<p>Consider Exercise 9.8:(a)Write an R function. (b)Write an Rcpp
function. (c)Compare the computation time of the two functions with the
function “microbenchmark”.</p>
</div>
<div id="answer-6-1" class="section level2">
<h2>Answer 6</h2>
<ol style="list-style-type: lower-alpha">
<li>Write an R function</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>GR<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,n,N)</span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>{</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span>y<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,<span class="fl">0.5</span>)</span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[<span class="dv">1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>x[<span class="dv">1</span>]<span class="sc">+</span>b)</span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>  {</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y[i<span class="dv">-1</span>])</span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x[i]<span class="sc">+</span>a,n<span class="sc">-</span>x[i]<span class="sc">+</span>b)</span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>  }</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(x,y),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a>  <span class="fu">return</span>(m)</span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a>}</span></code></pre></div>
<p>(b)Write an Rcpp function.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code=</span><span class="st">&#39;</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a><span class="st">// Function to perform the Gibbs sampling</span></span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a><span class="st">NumericMatrix GC(double a, double b, int n, int N) {</span></span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a><span class="st">  // Initialize vectors to store samples</span></span>
<span id="cb149-9"><a href="#cb149-9" tabindex="-1"></a><span class="st">  NumericVector x(N);</span></span>
<span id="cb149-10"><a href="#cb149-10" tabindex="-1"></a><span class="st">  NumericVector y(N);</span></span>
<span id="cb149-11"><a href="#cb149-11" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb149-12"><a href="#cb149-12" tabindex="-1"></a><span class="st">  // Initialize random number generator seed</span></span>
<span id="cb149-13"><a href="#cb149-13" tabindex="-1"></a><span class="st">  srand(time(NULL));</span></span>
<span id="cb149-14"><a href="#cb149-14" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb149-15"><a href="#cb149-15" tabindex="-1"></a><span class="st">  // Initialize x with initial value</span></span>
<span id="cb149-16"><a href="#cb149-16" tabindex="-1"></a><span class="st">  x[0] = R::rbinom(n,0.5);</span></span>
<span id="cb149-17"><a href="#cb149-17" tabindex="-1"></a><span class="st">  y[0] = R::rbeta(x[0]+a,n-x[0]+b);</span></span>
<span id="cb149-18"><a href="#cb149-18" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb149-19"><a href="#cb149-19" tabindex="-1"></a><span class="st">  // Perform Gibbs sampling</span></span>
<span id="cb149-20"><a href="#cb149-20" tabindex="-1"></a><span class="st">  for (int i = 1; i &lt; N; i++) {</span></span>
<span id="cb149-21"><a href="#cb149-21" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb149-22"><a href="#cb149-22" tabindex="-1"></a><span class="st">    x[i] = R::rbinom(n,y[i-1]);</span></span>
<span id="cb149-23"><a href="#cb149-23" tabindex="-1"></a><span class="st">    y[i] = R::rbeta(x[i]+a,n-x[i]+b);}</span></span>
<span id="cb149-24"><a href="#cb149-24" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb149-25"><a href="#cb149-25" tabindex="-1"></a><span class="st">  // Return stored samples as matrix</span></span>
<span id="cb149-26"><a href="#cb149-26" tabindex="-1"></a><span class="st">  NumericMatrix samples(N, 2);</span></span>
<span id="cb149-27"><a href="#cb149-27" tabindex="-1"></a><span class="st">  samples(_, 0) = x;</span></span>
<span id="cb149-28"><a href="#cb149-28" tabindex="-1"></a><span class="st">  samples(_, 1) = y;</span></span>
<span id="cb149-29"><a href="#cb149-29" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb149-30"><a href="#cb149-30" tabindex="-1"></a><span class="st">  return samples;</span></span>
<span id="cb149-31"><a href="#cb149-31" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p>(c)Compare the computation time of the two functions with the
function “microbenchmark”.</p>
<p>Denote n=10,a=1,b=2,N=10000</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">gr=</span><span class="fu">GR</span>(a,b,n,N),<span class="at">gc=</span><span class="fu">GC</span>(a,b,n,N))</span></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="fu">summary</span>(ts)</span></code></pre></div>
<pre><code>##   expr     min       lq      mean  median       uq      max neval
## 1   gr 41.4555 50.85100 59.983376 58.6547 64.97660 121.0270   100
## 2   gc  2.5182  2.74925  3.013311  2.9025  3.12505   4.7477   100</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
